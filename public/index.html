<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Murder Mystery Generator - Professional Edition</title>
  <meta name="description" content="ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«å“è³ªã®ãƒãƒ¼ãƒ€ãƒ¼ãƒŸã‚¹ãƒ†ãƒªãƒ¼ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ">
  <meta name="theme-color" content="#6d28d9">
  <meta name="color-scheme" content="dark light">
  
  <!-- Cache busting -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  
  <!-- Preconnect for faster font loading -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
  <!-- Critical CSS inline for faster initial render -->
  <style>
    body{margin:0;background:#0f0f23;color:#fff;font-family:Inter,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif}
    .hidden{display:none!important}
    .main-container{max-width:1200px;margin:0 auto;padding:0 1rem 4rem}
    .card{background:#1a1a2e;border-radius:16px;padding:2rem;box-shadow:0 4px 20px rgba(0,0,0,0.15)}
    .btn-primary{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border:none;padding:1rem 2rem;border-radius:16px;cursor:pointer;font-weight:600}
    .form-control{width:100%;padding:1rem;border:1px solid rgba(255,255,255,0.1);border-radius:16px;background:rgba(255,255,255,0.05);color:#fff}
    .loading{opacity:0.6;pointer-events:none}
    /* ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ”ãƒŠãƒ¼ */
    .loading-spinner{width:40px;height:40px;border:3px solid rgba(255,255,255,0.3);border-top-color:#667eea;border-radius:50%;animation:spin 0.8s linear infinite;margin:20px auto}
    @keyframes spin{to{transform:rotate(360deg)}}
    /* ãƒœã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ« */
    .btn-secondary{background:rgba(255,255,255,0.1);color:white;border:1px solid rgba(255,255,255,0.2);padding:1rem 2rem;border-radius:16px;cursor:pointer;font-weight:600}
    .btn-secondary:hover{background:rgba(255,255,255,0.15)}
  </style>
  
  <!-- Async load non-critical CSS with fallback -->
  <link rel="preload" href="ultra-modern-styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="ultra-modern-styles.css"></noscript>
  
  <!-- Font with display=swap for better performance -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- PWA & SEO -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%236d28d9'/><text y='65' x='50' text-anchor='middle' font-size='60' fill='white'>M</text></svg>">
</head>
<body>
  <!-- ğŸ¯ ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ - ã‚¹ã‚­ãƒƒãƒ—ãƒªãƒ³ã‚¯ -->
  <a href="#main-content" class="skip-link">ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¸ã‚¹ã‚­ãƒƒãƒ—</a>
  
  <header>
    <h1>Murder Mystery Generator</h1>
    <p>AIé§†å‹•ãƒãƒ¼ãƒ€ãƒ¼ãƒŸã‚¹ãƒ†ãƒªãƒ¼ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ </p>
  </header>

  <main class="main-container" id="main-content" role="main" aria-label="ãƒãƒ¼ãƒ€ãƒ¼ãƒŸã‚¹ãƒ†ãƒªãƒ¼ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ">

    <!-- ãƒ¡ã‚¤ãƒ³ã‚·ãƒŠãƒªã‚ªç”Ÿæˆã‚«ãƒ¼ãƒ‰ -->
    <div class="card bg-ultra-contrast" id="main-card">
      <div class="card-header">
        <h2>ã‚·ãƒŠãƒªã‚ªç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ </h2>
        <p>ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«å“è³ªã®ãƒãƒ¼ãƒ€ãƒ¼ãƒŸã‚¹ãƒ†ãƒªãƒ¼ã‚·ãƒŠãƒªã‚ªã‚’åŠ¹ç‡çš„ã«ç”Ÿæˆ</p>
      </div>
      
      <!-- çµ±åˆãƒ•ã‚©ãƒ¼ãƒ  -->
      <form id="scenario-form" class="form-container">
        <div class="form-section">
          <h3 class="text-gradient">ğŸ® åŸºæœ¬è¨­å®š</h3>
          
          <div class="form-grid">
            <div class="form-group">
              <label for="participants" class="form-label">ğŸ‘¥ å‚åŠ äººæ•°</label>
              <select id="participants" name="participants" class="form-control" required aria-describedby="participants-hint">
                <option value="4">4äºº (ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆ)</option>
                <option value="5" selected>5äºº (æ¨å¥¨)</option>
                <option value="6">6äºº (æ¨™æº–)</option>
                <option value="7">7äºº (å¤§è¦æ¨¡)</option>
                <option value="8">8äºº (ã‚¨ãƒ”ãƒƒã‚¯)</option>
              </select>
              <small id="participants-hint" class="form-hint">æ¨å¥¨ã¯5-6äººã§ã™</small>
            </div>
            
            <div class="form-group">
              <label for="era" class="form-label">â° æ™‚ä»£èƒŒæ™¯</label>
              <select id="era" name="era" class="form-control" required>
                <option value="modern" selected>ğŸ™ï¸ ç¾ä»£ (2020å¹´ä»£)</option>
                <option value="showa">ğŸ® æ˜­å’Œ (1926-1989)</option>
                <option value="near-future">ğŸš€ è¿‘æœªæ¥ (2030å¹´ä»£)</option>
                <option value="fantasy">ğŸ° ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="setting" class="form-label">ğŸ¢ èˆå°è¨­å®š</label>
              <select id="setting" name="setting" class="form-control" required>
                <option value="closed-space" selected>ğŸ  é–‰é–ç©ºé–“ (å¯†å®¤)</option>
                <option value="mountain-villa">ğŸ”ï¸ å±±è˜ (éš”é›¢)</option>
                <option value="military-facility">âš”ï¸ è»äº‹æ–½è¨­</option>
                <option value="underwater-facility">ğŸŒŠ æµ·ä¸­æ–½è¨­</option>
                <option value="city">ğŸŒ† éƒ½å¸‚éƒ¨</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h3 class="text-gradient">ğŸŒŸ ä¸–ç•Œè¦³ã¨ãƒˆãƒ¼ãƒ³</h3>
          
          <div class="form-grid">
            <div class="form-group">
              <label for="worldview" class="form-label">ğŸŒ ä¸–ç•Œè¦³</label>
              <select id="worldview" name="worldview" class="form-control">
                <option value="realistic" selected>ğŸ“± ãƒªã‚¢ãƒ«å¿—å‘ (ç¾å®Ÿçš„)</option>
                <option value="occult">ğŸ‘» ã‚ªã‚«ãƒ«ãƒˆè¦ç´ ã‚ã‚Š</option>
                <option value="sci-fi">ğŸ›¸ SFè¦ç´ ã‚ã‚Š</option>
                <option value="mystery">ğŸ” ç´”ç²‹ãƒŸã‚¹ãƒ†ãƒªãƒ¼</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="tone" class="form-label">ğŸ­ é›°å›²æ°—</label>
              <select id="tone" name="tone" class="form-control">
                <option value="serious" selected>ğŸ˜¤ ã‚·ãƒªã‚¢ã‚¹ (æœ¬æ ¼æ´¾)</option>
                <option value="light">ğŸ˜Š ãƒ©ã‚¤ãƒˆ (ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«)</option>
                <option value="horror">ğŸ˜± ãƒ›ãƒ©ãƒ¼ (ææ€–)</option>
                <option value="comedy">ğŸ¤£ ã‚³ãƒ¡ãƒ‡ã‚£ (ç¬‘ã„)</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="complexity" class="form-label">âš™ï¸ é›£æ˜“åº¦</label>
              <select id="complexity" name="complexity" class="form-control">
                <option value="simple">ğŸ”° ç°¡å˜ (30åˆ†)</option>
                <option value="standard" selected>âš–ï¸ æ¨™æº– (45åˆ†)</option>
                <option value="complex">ğŸ§  è¤‡é›‘ (60åˆ†)</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h3 class="text-gradient">ğŸ” äº‹ä»¶è¨­å®š</h3>
          
          <div class="form-grid">
            <div class="form-group">
              <label for="motive" class="form-label">ğŸ’° çŠ¯è¡Œå‹•æ©Ÿ</label>
              <select id="motive" name="motive" class="form-control">
                <option value="random" selected>ğŸ² ãŠã¾ã‹ã› (AIé¸æŠ)</option>
                <option value="money">ğŸ’° é‡‘éŠ­å•é¡Œ</option>
                <option value="revenge">âš”ï¸ å¾©è®</option>
                <option value="love">ğŸ’” æ‹æ„›é–¢ä¿‚</option>
                <option value="jealousy">ğŸ˜¡ å«‰å¦¬</option>
                <option value="secret">ğŸ¤« ç§˜å¯†ã®ç™ºè¦š</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="victim-type" class="form-label">ğŸ‘¤ è¢«å®³è€…ã‚¿ã‚¤ãƒ—</label>
              <select id="victim-type" name="victim-type" class="form-control">
                <option value="random" selected>ğŸ² ãŠã¾ã‹ã› (AIé¸æŠ)</option>
                <option value="wealthy">ğŸ’ è³‡ç”£å®¶</option>
                <option value="celebrity">â­ æœ‰åäºº</option>
                <option value="businessman">ğŸ’¼ å®Ÿæ¥­å®¶</option>
                <option value="ordinary">ğŸ‘¥ ä¸€èˆ¬äºº</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="weapon" class="form-label">ğŸ”ª å‡¶å™¨</label>
              <select id="weapon" name="weapon" class="form-control">
                <option value="random" selected>ğŸ² ãŠã¾ã‹ã› (AIé¸æŠ)</option>
                <option value="knife">ğŸ”ª åˆƒç‰©</option>
                <option value="poison">â˜ ï¸ æ¯’ç‰©</option>
                <option value="blunt">ğŸ”¨ éˆå™¨</option>
                <option value="unusual">ğŸ”§ å¤‰ã‚ã£ãŸç‰©</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h3 class="text-gradient">ğŸ¨ ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®š</h3>
          
          <div class="form-grid">
            <div class="form-group">
              <label for="generate_artwork" class="checkbox-label">
                <input type="checkbox" id="generate_artwork" name="generate_artwork" value="true" checked>
                <span class="checkmark"></span>
                ğŸ¨ ã‚¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ç”Ÿæˆã™ã‚‹
              </label>
              <div class="form-hint">DALL-E 3ã«ã‚ˆã‚‹ãƒ¡ã‚¤ãƒ³ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ï¼†ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¤ãƒ©ã‚¹ãƒˆä»˜ã</div>
            </div>
            
            <div class="form-group">
              <label for="detailed-handouts" class="checkbox-label">
                <input type="checkbox" id="detailed-handouts" name="detailed-handouts" value="true" checked>
                <span class="checkmark"></span>
                ğŸ“œ è©³ç´°ãªãƒãƒ³ãƒ‰ã‚¢ã‚¦ãƒˆã‚’ä½œæˆ
              </label>
              <div class="form-hint">ã‚ˆã‚Šè©³ã—ã„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®š</div>
            </div>
            
            <div class="form-group">
              <label for="gm-support" class="checkbox-label">
                <input type="checkbox" id="gm-support" name="gm-support" value="true" checked>
                <span class="checkmark"></span>
                ğŸ“ GMæ”¯æ´ãƒ„ãƒ¼ãƒ«ä»˜ã
              </label>
              <div class="form-hint">é€²è¡Œç®¡ç†ã¨ãƒ’ãƒ³ãƒˆæ©Ÿèƒ½</div>
            </div>
          </div>
        </div>

        <!-- ã‚«ã‚¹ã‚¿ãƒ è¦æ±‚ -->
        <div class="form-section">
          <h3 class="text-gradient">âœï¸ ã‚«ã‚¹ã‚¿ãƒ è¦æ±‚ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)</h3>
          <div class="form-group">
            <label for="custom-request" class="form-label">ç‰¹åˆ¥ãªè¦æœ›ãŒã‚ã‚Œã°è¨˜å…¥ã—ã¦ãã ã•ã„</label>
            <textarea id="custom-request" name="custom-request" class="form-control" rows="3" placeholder="ä¾‹: ç‰¹å®šã®è·æ¥­ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’å«ã‚ãŸã„ã€ç‰¹æ®Šãªãƒˆãƒªãƒƒã‚¯ã‚’ä½¿ã„ãŸã„ã€ãªã©..."></textarea>
          </div>
        </div>

        <!-- ç”Ÿæˆãƒœã‚¿ãƒ³ -->
        <div class="form-actions" role="group" aria-labelledby="generation-buttons-label">
          <h4 id="generation-buttons-label" class="visually-hidden">ã‚·ãƒŠãƒªã‚ªç”Ÿæˆã‚ªãƒ—ã‚·ãƒ§ãƒ³</h4>
          
          <button type="button" id="generate-btn" class="btn btn-primary btn-ultra-visible touch-target">
            ğŸš€ ã‚·ãƒŠãƒªã‚ªç”Ÿæˆé–‹å§‹
          </button>
          
          <!-- ğŸ² å®Œå…¨ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆãƒœã‚¿ãƒ³ -->
          <button type="button" id="random-generate-btn" class="btn btn-secondary btn-ultra-visible touch-target" style="margin-left: 15px;">
            ğŸ² å®Œå…¨ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆ
          </button>
          
          <div class="random-mode-info" style="margin-top: 10px; font-size: 0.9em; color: #666;" 
               aria-live="polite">
            ğŸ’¡ å®Œå…¨ãƒ©ãƒ³ãƒ€ãƒ ç”Ÿæˆã¯ã€AIãŒå®Œå…¨ã«è‡ªå¾‹çš„ã«ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒŸã‚¹ãƒ†ãƒªãƒ¼ã‚’å‰µä½œã—ã¾ã™
          </div>
        </div>
      </form>
    </div>

    <!-- ã‚·ãƒ³ãƒ—ãƒ«ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º -->
    <div id="loading-container" class="hidden" role="status" aria-live="polite" aria-label="ã‚·ãƒŠãƒªã‚ªç”Ÿæˆé€²è¡ŒçŠ¶æ³">
      <div class="loading-content">
        <div class="loading-header">
          <h2>ğŸ­ ãƒãƒ¼ãƒ€ãƒ¼ãƒŸã‚¹ãƒ†ãƒªãƒ¼ç”Ÿæˆä¸­...</h2>
          <div class="loading-spinner" aria-hidden="true"></div>
        </div>
        
        <div class="loading-info">
          <div class="current-phase" id="current-phase" aria-live="polite">AIç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³èµ·å‹•ä¸­...</div>
          <div class="phase-details" id="phase-details" aria-live="polite">æœ€é«˜å“è³ªã®ã‚·ãƒŠãƒªã‚ªã‚’ä½œæˆã—ã¦ã„ã¾ã™</div>
          
          <div class="progress-container" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" 
               aria-labelledby="progress-label">
            <div id="progress-label" class="visually-hidden">ç”Ÿæˆé€²æ—</div>
            <div class="progress-bar">
              <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="progress-stats" aria-live="polite">
              <span id="current-phase-number">0/9</span>
              <span id="estimated-time">æ¨å®šæ™‚é–“: ç´„ 5åˆ†</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- çµæœè¡¨ç¤º -->
    <div id="result-container" class="hidden">
      <div class="evidence-board">
        <div class="mystery-solved">
          <div id="scenario-content"></div>
          <div id="evidence-cards" class="evidence-cards-container"></div>
        </div>
      </div>
    </div>
  </main>

  <!-- ğŸš€ CORE APP - çµ±åˆJavaScriptã‚·ã‚¹ãƒ†ãƒ  -->
  <script src="js/core-app.js?v=2025012903" defer></script>
  
</body>
</html>